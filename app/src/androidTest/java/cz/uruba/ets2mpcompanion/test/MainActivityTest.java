package cz.uruba.ets2mpcompanion.test;

import android.support.test.espresso.matcher.ViewMatchers;
import android.support.v4.app.Fragment;
import android.test.ActivityInstrumentationTestCase2;

import org.junit.After;
import org.junit.Before;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import cz.uruba.ets2mpcompanion.MainActivity;
import cz.uruba.ets2mpcompanion.R;
import cz.uruba.ets2mpcompanion.fragments.MeetupListFragment;
import cz.uruba.ets2mpcompanion.fragments.ServerListFragment;
import okhttp3.HttpUrl;
import okhttp3.mockwebserver.Dispatcher;
import okhttp3.mockwebserver.MockResponse;
import okhttp3.mockwebserver.MockWebServer;
import okhttp3.mockwebserver.RecordedRequest;

import static android.support.test.espresso.Espresso.onView;
import static android.support.test.espresso.Espresso.openActionBarOverflowOrOptionsMenu;
import static android.support.test.espresso.Espresso.pressBack;
import static android.support.test.espresso.action.ViewActions.click;
import static android.support.test.espresso.action.ViewActions.swipeLeft;
import static android.support.test.espresso.action.ViewActions.swipeRight;
import static android.support.test.espresso.assertion.ViewAssertions.matches;
import static android.support.test.espresso.matcher.ViewMatchers.hasDescendant;
import static android.support.test.espresso.matcher.ViewMatchers.isDisplayed;
import static android.support.test.espresso.matcher.ViewMatchers.withId;
import static cz.uruba.ets2mpcompanion.test.matchers.WithToolbarTitle.withToolbarTitle;
import static org.hamcrest.Matchers.is;

public class MainActivityTest extends ActivityInstrumentationTestCase2<MainActivity> {
    private MainActivity activity;
    private MockWebServer mockServer;

    private final List<Integer> optionsMenuEntries = new ArrayList<>(
            Arrays.asList(
                    R.string.action_settings,
                    R.string.action_ets2mp_home,
                    R.string.action_ets2mp_forum,
                    R.string.action_ets2mp_convoys
            )
    );

    public MainActivityTest() {
        super(MainActivity.class);
    }

    @Override
    @Before
    protected void setUp() throws Exception {
        super.setUp();

        mockServer = new MockWebServer();

        final Dispatcher dispatcher = new Dispatcher() {

            @Override
            public MockResponse dispatch(RecordedRequest request) throws InterruptedException {

                if (request.getPath().equals("/servers/")){
                    return new MockResponse().setResponseCode(200).setBody("{\"error\":\"false\",\"response\":[{\"id\":1,\"game\":\"ETS2\",\"ip\":\"37.187.170.151\",\"port\":42860,\"name\":\"Europe 1\",\"shortname\":\"EU #1\",\"online\":true,\"players\":1330,\"maxplayers\":2300,\"speedlimiter\":1},{\"id\":3,\"game\":\"ETS2\",\"ip\":\"191.101.3.39\",\"port\":42860,\"name\":\"United states\",\"shortname\":\"US #1\",\"online\":true,\"players\":19,\"maxplayers\":1000,\"speedlimiter\":1},{\"id\":4,\"game\":\"ETS2\",\"ip\":\"151.80.230.166\",\"port\":42880,\"name\":\"Europe 2\",\"shortname\":\"EU #2\",\"online\":true,\"players\":1728,\"maxplayers\":2600,\"speedlimiter\":0},{\"id\":5,\"game\":\"ETS2\",\"ip\":\"37.187.170.151\",\"port\":42890,\"name\":\"Europe 3\",\"shortname\":\"EU #3\",\"online\":true,\"players\":338,\"maxplayers\":2300,\"speedlimiter\":1},{\"id\":6,\"game\":\"ETS2\",\"ip\":\"128.199.155.173\",\"port\":42860,\"name\":\"Asia\",\"shortname\":\"AS #1\",\"online\":true,\"players\":7,\"maxplayers\":500,\"speedlimiter\":1},{\"id\":7,\"game\":\"ETS2\",\"ip\":\"181.41.220.214\",\"port\":42860,\"name\":\"South America\",\"shortname\":\"SA #1\",\"online\":true,\"players\":141,\"maxplayers\":1500,\"speedlimiter\":0},{\"id\":9,\"game\":\"ATS\",\"ip\":\"37.187.170.151\",\"port\":42850,\"name\":\"Europe #1\",\"shortname\":\"EU #1\",\"online\":true,\"players\":0,\"maxplayers\":2000,\"speedlimiter\":1}]}");
                } else if (request.getPath().equals("/game_time/")){
                    return new MockResponse().setResponseCode(200).setBody("{\"error\":false,\"game_time\":874703}");
                } else if (request.getPath().equals("/meetups/")) {
                    return new MockResponse().setResponseCode(200).setBody("<!DOCTYPE html><html lang=\"en\"><head><title>ETS2:MP - Convoys &amp; Meetings</title><meta charset=\"UTF-8\"><meta name=description content=\"\"><meta name=viewport content=\"width=device-width, initial-scale=1\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'><link href=\"/css/reset.css\" rel=\"stylesheet\" media=\"screen\"><link href=\"/css//jquery.datetimepicker.css\" rel=\"stylesheet\" media=\"screen\"><link href=\"/css/style.css\" rel=\"stylesheet\" media=\"screen\"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-23387111-8', 'ets2c.com'); ga('send', 'pageview');</script></head><body><div id=\"login\"><div class=\"content\" id=\"login\"><div class=\"left\">You're not logged in.</div><div class=\"right\"><form action=\"auth-steam\" method=\"post\"><input type=\"image\" src=\"http://cdn.steamcommunity.com/public/images/signinthroughsteam/sits_small.png\"></form><div id=\"lang_chose\"><a href=\"/lang/en_US\" ><img src=\"/img/flags/gb.png\" alt=\"English\"/></a><a href=\"/lang/pl_PL\" class=\"faded\"><img src=\"/img/flags/pl.png\" alt=\"Polish\"/></a><a href=\"/lang/de_DE\" class=\"faded\"><img src=\"/img/flags/de.png\" alt=\"German\"/></a><a href=\"/lang/ro_RO\" class=\"faded\"><img src=\"/img/flags/ro.png\" alt=\"Romanian\"/></a><a href=\"/lang/fr_FR\" class=\"faded\"><img src=\"/img/flags/fr.png\" alt=\"Francais\"/></a><a href=\"/lang/tr_TR\" class=\"faded\"><img src=\"/img/flags/tr.png\" alt=\"Turkish\"/></a><a href=\"/lang/zh_CN\" class=\"faded\"><img src=\"/img/flags/cn.png\" alt=\"Chinese\"/></a><a href=\"/lang/es_ES\" class=\"faded\"><img src=\"/img/flags/es.png\" alt=\"Spanish\"/></a><a href=\"/lang/cs_CZ\" class=\"faded\"><img src=\"/img/flags/cz.png\" alt=\"Czech\"/></a><a href=\"/lang/pt_PT\" class=\"faded\"><img src=\"/img/flags/pt.png\" alt=\"Portuguese\"/></a><a href=\"/lang/sv_SE\" class=\"faded\"><img src=\"/img/flags/se.png\" alt=\"Swedish\"/></a></div></div></div></div><header><a href=\"/\"><div id=\"logo\">Convoys &amp; Meetings</div></a></header><div id=\"body\"><div class=\"content\"> <h2>Upcoming Events</h2> <br/><br/> <div class=\"table_list\"> <div class=\"row title\"> <div>Time</div><div>Location</div><div>Organiser</div><div>Language </div><div>Participants</div><div>&nbsp;</div></div><div class=\"row\"> <div>in 5 minutes</div><div>Växjö, Service Station (EU #1)</div><div>TO THE NORTH</div><div>English</div><div>10 (+ 2)</div><div><a href=\"view/41995/to-the-north-vxj-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 minutes</div><div>Wroclaw, Service Station (EU #1)</div><div>arek11326</div><div>Doesn&#039;t matter</div><div>4 </div><div><a href=\"view/42043/arek11326-wroclaw-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 14 hours</div><div>Aberdeen, Hotel (EU #1)</div><div>andreimrosca</div><div>Română</div><div>1 </div><div><a href=\"view/42046/andreimrosca-aberdeen-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 15 hours</div><div>Paris, Hotel (EU #1)</div><div>florian.dcn</div><div>Français</div><div>3 (+ 3)</div><div><a href=\"view/41770/floriandcn-paris-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 16 hours</div><div>Brussels, Service Station (EU #2)</div><div>piengamerbg</div><div>Български</div><div>1 </div><div><a href=\"view/42029/piengamerbg-brussels-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 16 hours</div><div>Paris, Hotel (EU #1)</div><div>ARBETER1</div><div>Deutsch</div><div>1 </div><div><a href=\"view/41196/arbeter1-paris-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 16 hours</div><div>Dover, Sea Port (EU #1)</div><div>[ETS2-R] Kazuki™ [CEO-JPN]</div><div>Doesn&#039;t matter</div><div>12 (+ 5)</div><div><a href=\"view/41982/ets2-r-kazukitm-ceo-jpn-dover-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 18 hours</div><div>Dortmund, Hotel (EU #1)</div><div>[Euro-Trans Owner]*Cirrus</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/42019/euro-trans-ownercirrus-dortmund-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 18 hours</div><div>Strasbourg, Hotel (EU #1)</div><div>[LKW Tr.] Leo™ (UK)</div><div>Doesn&#039;t matter</div><div>14 (+ 7)</div><div><a href=\"view/41648/lkw-tr-leotm-uk-strasbourg-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 19 hours</div><div>Liverpool, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>4 </div><div><a href=\"view/41257/tons-transport-liamcn26-liverpool-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 19 hours</div><div>Carlisle, Service Station (EU #2)</div><div>TheFadedBrit</div><div>English</div><div>1 </div><div><a href=\"view/42042/thefadedbrit-carlisle-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 21 hours</div><div>Wroclaw, Hotel (EU #2)</div><div>GHOSTMEN_PL</div><div>Polski</div><div>1 (+ 2)</div><div><a href=\"view/42028/ghostmen-pl-wroclaw-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 21 hours</div><div>Lyon, Quarry (EU #2)</div><div>[TSRVTC - Driver] Mirrland</div><div>English</div><div>5 (+ 5)</div><div><a href=\"view/40907/tsrvtc-driver-mirrland-lyon-quarry\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Oslo, Hotel (EU #2)</div><div>Samuel</div><div>Doesn&#039;t matter</div><div>3 (+ 1)</div><div><a href=\"view/41335/samuel-oslo-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Göteborg, Service Station (EU #1)</div><div>Túrókarima</div><div>English</div><div>1 </div><div><a href=\"view/41756/trkarima-gteborg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Oslo, Bus Station (EU #2)</div><div>alfred.erdelius</div><div>Doesn&#039;t matter</div><div>2 </div><div><a href=\"view/42025/alfrederdelius-oslo-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Göteborg, Service Station (EU #1)</div><div>Túrókarima</div><div>Magyar</div><div>1 </div><div><a href=\"view/41815/trkarima-gteborg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Osnabruck, Service Station (EU #1)</div><div>TurBoSkilleR</div><div>Deutsch</div><div>1 </div><div><a href=\"view/40794/turboskiller-osnabruck-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Hannover, Truck Dealer (EU #2)</div><div>FerOmsi</div><div>Deutsch</div><div>2 (+ 1)</div><div><a href=\"view/41726/feromsi-hannover-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Rotterdam, Service Station (EU #1)</div><div>Gytis[LT]</div><div>Lietuvių</div><div>1 </div><div><a href=\"view/42033/gytislt-rotterdam-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Rostock, Service Station (EU #1)</div><div>Jogger506</div><div>English</div><div>1 </div><div><a href=\"view/41998/jogger506-rostock-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Magdeburg, E-Acres (EU #3)</div><div>[ConSecGroup] jordan</div><div>English</div><div>4 </div><div><a href=\"view/41974/consecgroup-jordan-magdeburg-e-acres\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Milano , Tree-Et (EU #3)</div><div>Frozenfire Virtual Photography</div><div>FROZEN ON TOUR</div><div>8 (+ 3)</div><div><a href=\"view/41523/frozenfire-virtual-photography-milano-tree-et\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Paris, Hotel (EU #1)</div><div>Euro transport FR Patron Séb</div><div>Français</div><div>6 (+ 7)</div><div><a href=\"view/41810/euro-transport-fr-patron-sb-paris-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>London, San Builders (EU #3)</div><div>Alex-Game (ITA)</div><div>Italiano</div><div>4 (+ 1)</div><div><a href=\"view/40996/alex-game-ita-london-san-builders\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Debrecen, Hotel (EU #2)</div><div>YAYALAR I RAMAZAN</div><div>Türkçe</div><div>1 (+ 1)</div><div><a href=\"view/41781/yayalar-i-ramazan-debrecen-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Graz, Hotel (EU #1)</div><div>emanuel200220</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/38568/emanuel200220-graz-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Frankfurt, Hotel (EU #2)</div><div>(GER&amp;HUN)AQUILA-ChrisRobin</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41631/gerhunaquila-chrisrobin-frankfurt-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Frankfurt, Hotel (EU #2)</div><div>(GER&amp;HUN)AQUILA-ChrisRobin</div><div>Deutsch</div><div>1 </div><div><a href=\"view/41632/gerhunaquila-chrisrobin-frankfurt-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Frankfurt, Hotel (EU #2)</div><div>(GER&amp;HUN)AQUILA-ChrisRobin</div><div>English</div><div>1 </div><div><a href=\"view/41633/gerhunaquila-chrisrobin-frankfurt-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Birmingham, Hotel (EU #2)</div><div>Voltiac™</div><div>English</div><div>1 </div><div><a href=\"view/41968/voltiactm-birmingham-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Paris, Service Station (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>2 </div><div><a href=\"view/41857/grofrrgoiano-002-br-paris-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 days</div><div>Kassel, Hotel (EU #1)</div><div>Greekanian Google</div><div>Doesn&#039;t matter</div><div>7 </div><div><a href=\"view/41838/greekanian-google-kassel-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Mannheim, Service Station (EU #2)</div><div>»TFL«Papalapup(GER)</div><div>Deutsch</div><div>3 (+ 2)</div><div><a href=\"view/41522/tflpapalapupger-mannheim-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>ETR Truck Hunt,London, NBFC (EU #3)</div><div>[ETRVTC] Mark P [EM]</div><div>Doesn&#039;t matter</div><div>3 (+ 2)</div><div><a href=\"view/41091/etrvtc-mark-p-em-etr-truck-huntlondon-nbfc\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Osnabruck, eAcres (EU #1)</div><div>FCT | jacob.lovekw | CEO</div><div>firstclasstrans.co.uk</div><div>2 (+ 3)</div><div><a href=\"view/41834/fct-jacoblovekw-ceo-osnabruck-eacres\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Frankfurt, Service Station (EU #2)</div><div>good_luck</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/42031/good-luck-frankfurt-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Poznan, Service Station (EU #1)</div><div>Sardjon</div><div>Estonian</div><div>4 (+ 3)</div><div><a href=\"view/41809/sardjon-poznan-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Budapest, Service Station (EU #2)</div><div>[SSC] Levitation21 [EM]</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/37475/ssc-levitation21-em-budapest-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Linz, Hotel (EU #2)</div><div>[TruckSec. Chef]Luki Korni[GER]</div><div>Deutsch</div><div>1 (+ 1)</div><div><a href=\"view/41205/trucksec-chefluki-korniger-linz-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Milano, Service Station (EU #2)</div><div>[ÖZ DOSTLAR] ONUR-17</div><div>Türkçe</div><div>11 (+ 2)</div><div><a href=\"view/41750/z-dostlar-onur-17-milano-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Jönköping, Norrfood (EU #3)</div><div>[ConSecGroup] jordan</div><div>English</div><div>3 </div><div><a href=\"view/42018/consecgroup-jordan-jnkping-norrfood\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 days</div><div>Lublin, Truck Dealer (EU #2)</div><div>[JNR-SNR] Senior</div><div>English</div><div>5 (+ 1)</div><div><a href=\"view/41934/jnr-snr-senior-lublin-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Praha, Service Station (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>3 </div><div><a href=\"view/41858/grofrrgoiano-002-br-praha-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Nurnberg, Hotel (EU #2)</div><div>TAKLA LOJİSTİK ( DOĞUKAN )</div><div>Türkçe</div><div>2 (+ 2)</div><div><a href=\"view/40107/takla-lojstk-doukan-nurnberg-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Paris, Hotel (EU #2)</div><div>[FR] Waylon</div><div>Français</div><div>4 (+ 1)</div><div><a href=\"view/39262/fr-waylon-paris-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Amsterdam, Hotel (EU #2)</div><div>Marcelo Pinho</div><div>English</div><div>1 </div><div><a href=\"view/42010/marcelo-pinho-amsterdam-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Torino, Transinet (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>7 (+ 5)</div><div><a href=\"view/41182/tsrvtc-cc-manager-iholby-torino-transinet\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Bratislava, Hotel (US #1)</div><div>Twingo</div><div>English</div><div>1 </div><div><a href=\"view/41976/twingo-bratislava-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Verona, Eac (EU #1 Carnival P)</div><div>(*E=W=T*&amp;*R=E=T*) ^,. NaTsU .,^</div><div>Nederlands/English</div><div>11 (+ 16)</div><div><a href=\"view/26260/ewtret-natsu-verona-eac-\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 days</div><div>Hamburg, Bus Station (EU #2)</div><div>Spedition-Gva(Ger)sven</div><div>Deutsch</div><div>3 (+ 1)</div><div><a href=\"view/42044/spedition-gvagersven-hamburg-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 days</div><div>Plymouth, Bus Station (EU #2)</div><div>[TTL-LH]JACK</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/42022/ttl-lhjack-plymouth-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 days</div><div>Groningen, EAcres (EU #2)</div><div>[TSRVTC - Driver] Mirrland</div><div>English</div><div>3 (+ 1)</div><div><a href=\"view/41080/tsrvtc-driver-mirrland-groningen-eacres\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 days</div><div>Groningen, Hotel (EU #1)</div><div>dutch boy speaking english</div><div>English</div><div>12 (+ 3)</div><div><a href=\"view/41695/dutch-boy-speaking-english-groningen-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 7 days</div><div>Plymouth, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41260/tons-transport-liamcn26-plymouth-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 7 days</div><div>Linz, ITCC (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>3 (+ 2)</div><div><a href=\"view/41183/tsrvtc-cc-manager-iholby-linz-itcc\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Calais, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 (+ 1)</div><div><a href=\"view/41261/tons-transport-liamcn26-calais-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Dover, Sea Port (EU #2)</div><div>I.H.T | PandowlDesigns</div><div>I.H.T | ANNUAL TRUCKFEST</div><div>5 (+ 1)</div><div><a href=\"view/41090/iht-pandowldesigns-dover-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Dover, Sea Port (EU #2)</div><div>[TSRVTC - Driver] Mirrland</div><div>English</div><div>5 (+ 1)</div><div><a href=\"view/41086/tsrvtc-driver-mirrland-dover-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>London, Hotel (EU #2)</div><div>(GER&amp;HUN)AQUILA-ChrisRobin</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/39359/gerhunaquila-chrisrobin-london-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Carlisle, Service Station (EU #1)</div><div>Jogger506</div><div>English</div><div>1 </div><div><a href=\"view/41999/jogger506-carlisle-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Paris, Hotel (EU #2)</div><div>[TürkiyeLojistik]EfeToprak</div><div>Türkçe</div><div>16 (+ 5)</div><div><a href=\"view/36038/trkiyelojistikefetoprak-paris-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Calais, Hotel (EU #1)</div><div>Transport RG Lylian Pelletier</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41151/transport-rg-lylian-pelletier-calais-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Mannheim, Bus Station (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>1 </div><div><a href=\"view/41866/grofrrgoiano-002-br-mannheim-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Kiel, Service Station (EU #2)</div><div>[ÖZ DOSTLAR] ONUR-17</div><div>Türkçe</div><div>6 </div><div><a href=\"view/41753/z-dostlar-onur-17-kiel-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Frankfurt, Service Station (EU #2)</div><div>YellowDay_HD</div><div>Deutsch</div><div>1 </div><div><a href=\"view/41943/yellowday-hd-frankfurt-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 week</div><div>Kristiansand, Hotel (EU #2)</div><div>[B.E.D] FawnPrince</div><div>Doesn&#039;t matter</div><div>21 (+ 8)</div><div><a href=\"view/33742/bed-fawnprince-kristiansand-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Göteborg, Norrsken (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>4 (+ 1)</div><div><a href=\"view/41185/tsrvtc-cc-manager-iholby-gteborg-norrsken\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Linz, Service Station (US #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>1 </div><div><a href=\"view/41867/grofrrgoiano-002-br-linz-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Stuttgart, Hotel (EU #2)</div><div>Claas-Power</div><div>Polski</div><div>2 (+ 1)</div><div><a href=\"view/41962/claas-power-stuttgart-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Dijon, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41262/tons-transport-liamcn26-dijon-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Southampton, Transinet (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>4 (+ 1)</div><div><a href=\"view/41187/tsrvtc-cc-manager-iholby-southampton-transinet\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Milano, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41263/tons-transport-liamcn26-milano-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Dortmund, Service Station (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>1 </div><div><a href=\"view/41869/grofrrgoiano-002-br-dortmund-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 weeks</div><div>Amsterdam, Hotel (EU #1)</div><div>mricecool60_nl</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/40355/mricecool60-nl-amsterdam-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Koln, Service Station (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>1 </div><div><a href=\"view/41870/grofrrgoiano-002-br-koln-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Lublin, LKW (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>4 (+ 1)</div><div><a href=\"view/41189/tsrvtc-cc-manager-iholby-lublin-lkw\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Calais, NBFC Company Yard (EU #1)</div><div>[RAW™] TeamRaw [CEO](Can)</div><div>English/All languages welcome</div><div>7 (+ 5)</div><div><a href=\"view/36284/rawtm-teamraw-ceocan-calais-nbfc-company-yard\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Munchen, Truck Dealer (EU #2)</div><div>[RO]MysticLogistics[MRN]</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/40559/romysticlogisticsmrn-munchen-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Erfurt, Service Station (EU #2)</div><div>ipetko1159</div><div>Български</div><div>1 (+ 1)</div><div><a href=\"view/40747/ipetko1159-erfurt-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Calais, Sea Port (EU #2)</div><div>Fanto66</div><div>Français</div><div>1 </div><div><a href=\"view/41497/fanto66-calais-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Salzburg, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41264/tons-transport-liamcn26-salzburg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Salzburg, Transinet (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>3 (+ 1)</div><div><a href=\"view/41191/tsrvtc-cc-manager-iholby-salzburg-transinet\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Calais, Sea Port (EU #2)</div><div>F-H-L Owner Foxy1314 |</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41521/f-h-l-owner-foxy1314-calais-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Bratislava, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>2 </div><div><a href=\"view/41265/tons-transport-liamcn26-bratislava-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Stavanger, Sea Port (EU #1)</div><div>*G.R.OFR*®Goiano |002| [BR]</div><div>Português</div><div>1 </div><div><a href=\"view/41872/grofrrgoiano-002-br-stavanger-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Calais, Sea Port (EU #2)</div><div>F-H-L Owner Foxy1314 |</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41176/f-h-l-owner-foxy1314-calais-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Nurnberg, Service Station (EU #1)</div><div>[94th] Jerry</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41297/94th-jerry-nurnberg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 weeks</div><div>Dortmund, Hotel (EU #2)</div><div>0075yusuf007</div><div>Türkçe</div><div>1 </div><div><a href=\"view/41310/0075yusuf007-dortmund-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Stavanger, Nordic Crown (EU #2)</div><div>[TSRVTC - CC Manager] iHolby</div><div>Doesn&#039;t matter</div><div>4 (+ 1)</div><div><a href=\"view/41192/tsrvtc-cc-manager-iholby-stavanger-nordic-crown\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Wroclaw, Hotel (EU #2)</div><div>[FR/VN] Julien nry</div><div>Français</div><div>1 </div><div><a href=\"view/41710/fr-vn-julien-nry-wroclaw-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Linköping, Hotel (EU #1)</div><div>[FR/VN] Julien nry</div><div>Français</div><div>1 </div><div><a href=\"view/41712/fr-vn-julien-nry-linkping-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Wroclaw, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41267/tons-transport-liamcn26-wroclaw-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Växjö, Service Station (EU #2)</div><div>TR | autokingvw</div><div>English</div><div>1 </div><div><a href=\"view/41794/tr-autokingvw-vxj-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 4 weeks</div><div>Szczecin, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>2 </div><div><a href=\"view/42020/tons-transport-liamcn26-szczecin-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 month</div><div>Luxembourg, Service Station (EU #1)</div><div>MD chavez</div><div>Español</div><div>8 (+ 4)</div><div><a href=\"view/39886/md-chavez-luxembourg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 month</div><div>Kiel, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>3 </div><div><a href=\"view/41269/tons-transport-liamcn26-kiel-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 month</div><div>Brno, Truck Dealer (EU #1)</div><div>[MNE] Hasan</div><div>Doesn&#039;t matter</div><div>2 </div><div><a href=\"view/39110/mne-hasan-brno-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 month</div><div>Paleto Bay, Parking Area (Invite Only)</div><div>Amazing Panda</div><div>English</div><div>6 </div><div><a href=\"view/39514/amazing-panda-paleto-bay-parking-area\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 1 month</div><div>Duisbourg, Service Station (EU #2)</div><div>[TONS-Transport] Liamcn26</div><div>English</div><div>2 </div><div><a href=\"view/41270/tons-transport-liamcn26-duisbourg-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 months</div><div>Oslo, Sea Port (EU #2)</div><div>DJ Trademark™ | Truckers.FM</div><div>English</div><div>5 (+ 3)</div><div><a href=\"view/41833/dj-trademarktm-truckersfm-oslo-sea-port\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 months</div><div>Birmingham, Service Station (EU #1)</div><div>unn4r</div><div>Polski</div><div>2 (+ 1)</div><div><a href=\"view/41303/unn4r-birmingham-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 months</div><div>Birmingham, Service Station (EU #1)</div><div>unn4r</div><div>Polski</div><div>1 (+ 1)</div><div><a href=\"view/41304/unn4r-birmingham-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 2 months</div><div>Poznan, Service Station (EU #1)</div><div>kacper.syta14</div><div>Polski</div><div>9 (+ 2)</div><div><a href=\"view/37647/kacpersyta14-poznan-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 3 months</div><div>Newcastle, Service Station (EU #1)</div><div>LILLESKUTT</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41496/lilleskutt-newcastle-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 months</div><div>Poznan, Hotel (EU #1)</div><div>ryba.04</div><div>Polski</div><div>1 </div><div><a href=\"view/40659/ryba04-poznan-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 6 months</div><div>Calais, Bus Station (EU #2)</div><div>Le Simulateur Manchot</div><div>Français</div><div>1 (+ 3)</div><div><a href=\"view/36682/le-simulateur-manchot-calais-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 11 months</div><div>Berlin, Truck Dealer (EU #2)</div><div>Arschi 2.0</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/38091/arschi-20-berlin-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 11 months</div><div>Frankfurt, Bus Station (EU #2)</div><div>(GER&amp;HUN)AQUILA-ChrisRobin</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/40000/gerhunaquila-chrisrobin-frankfurt-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 5 years</div><div>Aberdeen, Hotel (EU #1)</div><div>ГАЙК УЕБАН</div><div>Doesn&#039;t matter</div><div>115 (+ 24)</div><div><a href=\"view/35393/-aberdeen-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 9 years</div><div>Paris, Bus Station (EU #1)</div><div>| T.I.C | P | Dunry [ FR/EN]</div><div>Français</div><div>73 (+ 20)</div><div><a href=\"view/36305/-tic-p-dunry-fr-en-paris-bus-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 14 years</div><div>Aberdeen, Service Station (EU #1)</div><div>[BG] to6oo952</div><div>Doesn&#039;t matter</div><div>3 (+ 1)</div><div><a href=\"view/40108/bg-to6oo952-aberdeen-service-station\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 19 years</div><div>Aberdeen, Hotel (EU #1)</div><div>Woensel</div><div>Doesn&#039;t matter</div><div>1 </div><div><a href=\"view/41920/woensel-aberdeen-hotel\" class=\"button\">More Info</a></div></div><div class=\"row\"> <div>in 20 years</div><div>Liege, Truck Dealer (EU #2)</div><div>anbora</div><div>English</div><div>62 (+ 19)</div><div><a href=\"view/39269/anbora-liege-truck-dealer\" class=\"button\">More Info</a></div></div><div class=\"clear\"></div></div><br/><br/> <h2>Want to organize an event?</h2> <br/><br/> <div class=\"center\"> <a href=\"create\" class=\"button big\">Organize a convoy or meeting</a> </div></div></div><div id=\"footer\"><div class=\"content\"><div class=\"third\"><b class=\"title\">Partners</b><ul> <li><a href=\"http://www.ets2.ro\" target=\"_blank\">ETS2.ro - Romanian Forum</a></li><li><a href=\"http://ets2mp.de\" target=\"_blank\">ETS2MP.de - German Forum</a></li><li><a href=\"http://www.ets2mptr.com\" target=\"_blank\">ETS2MPTR.com - Turkish Forum</a></li><li><a href=\"http://ets2mpbr.com\" target=\"_blank\">ETS2:MP Brasil - Fanpage</a></li><li><a href=\"http://ets2mp.sk\" target=\"_blank\">ETS2:MP - Czecho-Slovakian Forum</a></li></ul></div><div class=\"third\"><b class=\"title\">Suggestions / Ideas?</b><ul><li><a href=\"http://forum.ets2mp.com/member.php?action=profile&amp;uid=7575\" target=\"_blank\">Send me a forum PM.</a></li></ul></div><div class=\"third\"><b class=\"title\">About ETS2C.com</b><ul><li>This website has been created by <a href=\"http://forum.ets2mp.com/member.php?action=profile&amp;uid=7575\" target=\"_blank\">woot (forum profile).</a></li><li>I am not affiliated to ETS2:MP or SCS Software.</li></ul></div><div class=\"clear\"></div></div></div><script type=\"text/javascript\" src=\"//code.jquery.com/jquery-2.1.1.min.js\"></script><script type=\"text/javascript\" src=\"/js/jquery.datetimepicker.js\"></script><script type=\"text/javascript\" src=\"/js/autogrow.js\"></script><script type=\"text/javascript\">var aMessages={};aMessages['loc_time']=\"In your local time, that would be\";aMessages['desc_warning']=\"Please enter a proper description. (Minimum 100 characters)\";aMessages['please_wait']=\"Please wait..\";</script><script type=\"text/javascript\" src=\"/js/main.js\"></script></body></html>");
                }
                return new MockResponse().setResponseCode(404);
            }
        };

        mockServer.setDispatcher(dispatcher);

        mockServer.start(52734);

        HttpUrl baseUrl = mockServer.url("/");

        activity = getActivity();
    }

    @Override
    @After
    protected void tearDown() throws Exception {
        mockServer.shutdown();

        super.tearDown();
    }

    public void testFragmentCollection() {
        List<Fragment> fragments = activity.getSupportFragmentManager().getFragments();

        // there have to be fragments
        assertNotNull(fragments);

        // 2 fragments, to be precise
        assertEquals(2, fragments.size());

        // the first one we create is a ServerListFragment
        assertTrue(fragments.get(0) instanceof ServerListFragment);

        // and the second one is a MeetupListFragment
        assertTrue(fragments.get(1) instanceof MeetupListFragment);
    }

    public void testViewPagerSwipe() {
        // the ViewPager must have precisely the following descendants
        onView(withId(R.id.viewpager)).check(matches(hasDescendant(withId(R.id.recyclerview_serverlist))));
        onView(withId(R.id.viewpager)).check(matches(hasDescendant(withId(R.id.recyclerview_meetuplist))));

        // now we test which of them is displayed before and after swiping
        onView(withId(R.id.recyclerview_serverlist)).check(matches(isDisplayed()));
        onView(withId(R.id.viewpager)).perform(swipeLeft());
        onView(withId(R.id.recyclerview_meetuplist)).check(matches(isDisplayed()));
        onView(withId(R.id.viewpager)).perform(swipeRight());
        onView(withId(R.id.recyclerview_serverlist)).check(matches(isDisplayed()));
    }

    public void testOptionsMenu() {
        // for every option menu entry we try to click it, check that the main Toolbar's title matches, and then go back
        for (int optionsMenuEntry : optionsMenuEntries) {
            openActionBarOverflowOrOptionsMenu(getInstrumentation().getTargetContext());

            onView(ViewMatchers.withText(optionsMenuEntry)).perform(click());
            onView(withId(cz.uruba.ets2mpcompanion.R.id.toolbar)).check(matches(withToolbarTitle(is(activity.getString(optionsMenuEntry)))));

            pressBack();
        }
    }
}
